# Mood Journalï½œæƒ…ç·’æ—¥è¨˜ Web MVP

ä»¥ React + Vite æ‰“é€ çš„æ¥µç°¡æƒ…ç·’æ—¥è¨˜ï¼Œä½œç‚ºã€Œ30 å¤© Vibe Codingã€ç³»åˆ—çš„ç¬¬äºŒç¯‡ç« ã€‚å·²æŽ¥å…¥ Firebaseï¼šæ”¯æ´ Google ç™»å…¥èˆ‡ Firestore é›²ç«¯å„²å­˜ï¼ˆè·¯å¾‘ `users/{uid}/diaries/{docId}`ï¼‰ã€‚

## åŠŸèƒ½ç‰¹è‰²

### ç•¶å‰ï¼ˆDay 13 ç‰ˆï¼‰

- Google ç™»å…¥ï¼šLoginPage æä¾› Google ç™»å…¥æŒ‰éˆ•
- ä¿è­·è·¯ç”±ï¼šæœªç™»å…¥å°Žå‘ `/login`ï¼Œç™»å…¥å¾Œé€²å…¥ `/`
- é›²ç«¯å„²å­˜ï¼šä½¿ç”¨è€…æ—¥è¨˜å­˜æ–¼ Firestore `users/{uid}/diaries/{docId}`
- æ–°å¢ž/ç·¨è¼¯/åˆªé™¤ï¼šDiaryPage å¯æ–°å¢žã€ç·¨è¼¯ã€åˆªé™¤ï¼ˆè»Ÿåˆªé™¤ `isDeleted=true`ï¼‰
- æŽ’åºï¼šæ¸…å–®ä¾æ—¥æœŸæ–° â†’ èˆŠæŽ’åº
- åŸºæœ¬é˜²å‘†ï¼šå…§å®¹ç©ºç™½ç„¡æ³•å­˜æª”ï¼›å­˜æª”å¾Œè‡ªå‹•æ¸…ç©ºè¼¸å…¥æ¡†

### é‡Œç¨‹ç¢‘ï¼ˆDay 12â€“29ï¼‰

- Day 11ï¼šæ—¥è¨˜mvp
- Day 12ï¼šFirestore ä¸²æŽ¥ + å¸³è™Ÿç™»å…¥ï¼ˆåƒ…æœ¬äººå¯è¦‹ï¼‰
- Day 13ï¼šCRUDï¼ˆç·¨è¼¯ã€åˆªé™¤ã€æŽ’åºï¼‰
- Day 14ï¼šåŸºç¤Žæ–‡å­—æƒ…ç·’åˆ†æžï¼ˆæ­£å‘/ä¸­ç«‹/è² å‘ï¼‰
- Day 15ï¼šæƒ…ç·’è¦–è¦ºåŒ–ï¼ˆæŠ˜ç·šåœ– + æœˆæ›†ç†±åŠ›åœ–ï¼‰
- Day 16ï¼šæ¨™ç±¤èˆ‡æœå°‹ï¼ˆtag / æ—¥æœŸç¯©é¸ï¼‰
- Day 17ï¼šæé†’èˆ‡é€šçŸ¥ï¼ˆæ¯æ—¥æé†’å¯«æ—¥è¨˜ï¼‰
- Day 18ï¼šéš±ç§èˆ‡å®‰å…¨ï¼ˆFirestore Rulesã€æœ¬åœ°åŠ å¯†é¸é …ï¼‰
- Day 19ï¼šåŒ¯å‡ºï¼åŒ¯å…¥ï¼ˆJSON/CSVï¼‰
- Day 20ï¼šPWA é›¢ç·šæ¨¡å¼ï¼ˆé›¢ç·šå¯å¯«ï¼Œä¸Šç·šè‡ªå‹•åŒæ­¥ï¼‰
- Day 21ï¼šæ¸¬è©¦ã€éƒ¨ç½²èˆ‡äº‹ä»¶è¿½è¹¤ï¼ˆPlaywrightã€Vercelã€GA4/PostHogï¼‰
- Day 22â€“23ï¼šé€²éšŽæ–‡å­—æƒ…ç·’åˆ†é¡žå™¨ï¼‹å¯è§£é‡‹æ€§ï¼ˆHuggingFaceã€ä¿¡å¿ƒåˆ†æ•¸ã€é—œéµè©žè²¢ç»ï¼‰
- Day 24ï¼šå°‡é€²éšŽåˆ†é¡žå™¨æ•´åˆå›žæ—¥è¨˜ï¼ˆæ›´æº–ç¢ºçš„æ¨™ç±¤èˆ‡ä¿¡å¿ƒï¼‰
- Day 25ï¼šèªžéŸ³è¼¸å…¥ï¼ˆéŒ„éŸ³ â†’ è½‰æ–‡å­—ï¼‰
- Day 26ï¼šèªžéŸ³æƒ…ç·’æ¨¡åž‹æŒ‘é¸ï¼ˆdataset èˆ‡ baselineï¼‰
- Day 27ï¼šèªžéŸ³ API ä¸²æŽ¥èˆ‡ Demoï¼ˆæ©ŸçŽ‡åˆ†å¸ƒé¡¯ç¤ºï¼‰
- Day 28ï¼šæ•ˆæžœé©—è­‰ï¼ˆUAR â‰¥ 0.6ã€æ··æ·†çŸ©é™£ã€F1ï¼‰
- Day 29ï¼šæ–‡å­— Ã— èªžéŸ³èžåˆï¼ˆLate Fusionï¼‰ï¼‹ éš±ç§é¸é …

## æŠ€è¡“æž¶æ§‹

- æ¡†æž¶ï¼šReact 19
- å»ºç½®å·¥å…·ï¼šVite 7
- èªžè¨€ï¼šJavaScriptï¼ˆå¯é€æ­¥å°Žå…¥ TypeScriptï¼‰
- ç‹€æ…‹ç®¡ç†ï¼šReact Hooksï¼ˆ`useState`ã€`useEffect`ã€`useMemo`ï¼‰
- è·¯ç”±ï¼šReact Router v6
- èº«åˆ†é©—è­‰ï¼šFirebase Authï¼ˆGoogleï¼‰
- è³‡æ–™åº«ï¼šCloud Firestoreï¼ˆ`users/{uid}/diaries/{docId}`ï¼‰

## å®‰å…¨èˆ‡éš±ç§

- Firestore è¦å‰‡ï¼šå¸³è™Ÿéš”é›¢ï¼ˆè¦‹ `firestore.rules`ï¼‰
  - åªå…è¨±æœ¬äººè®€å¯«è‡ªå·±çš„è³‡æ–™ï¼š
    - `users/{uid}/diaries/{docId}`ï¼ˆæ—¥è¨˜ï¼‰
    - `users/{uid}/profile/{docId}`ï¼ˆæé†’è¨­å®šï¼‰
  - è¦å‰‡éƒ¨ç½²ï¼š
    - Consoleï¼šFirestore â†’ Rules â†’ è²¼ä¸Šå¾Œ Publish
    - æˆ– CLIï¼š`firebase deploy --only firestore:rules`
- æœ¬åœ°åŠ å¯†ï¼ˆå‰ç«¯ï¼‰ï¼š
  - å¯«å…¥æ™‚ç”¨ AES åŠ å¯†å…§å®¹ï¼ŒFirestore å„²å­˜å¯†æ–‡æ¬„ä½ `contentEnc`
  - è®€å–æ™‚åœ¨å‰ç«¯è§£å¯†å¾Œé¡¯ç¤ºæ˜Žæ–‡ï¼ˆç›¸å®¹èˆŠè³‡æ–™ï¼‰

## å¿«é€Ÿé–‹å§‹

ç’°å¢ƒéœ€æ±‚ï¼šNode.js 18+ã€npm

```bash
# å®‰è£ä¾è³´
npm install

# é–‹ç™¼æ¨¡å¼
npm run dev

# å»ºç½®ç”¢ç‰©
npm run build

# æœ¬åœ°é è¦½ï¼ˆé è¨­ http://localhost:5173ï¼‰
npm run preview
```

### Firebase è¨­å®š

1) åœ¨ Firebase Console å»ºç«‹å°ˆæ¡ˆèˆ‡ Web Appï¼Œå•Ÿç”¨ Authenticationï¼ˆGoogleï¼‰èˆ‡ Firestoreã€‚

2) å»ºç«‹ `.env.local`ï¼Œå¡«å…¥å°ˆæ¡ˆè¨­å®šï¼ˆVite ä½¿ç”¨ `VITE_` å‰ç¶´ï¼‰ï¼š

```
VITE_FIREBASE_API_KEY=xxx
VITE_FIREBASE_AUTH_DOMAIN=xxx.firebaseapp.com
VITE_FIREBASE_PROJECT_ID=xxx
VITE_FIREBASE_APP_ID=1:xxxx:web:xxxx
VITE_FIREBASE_STORAGE_BUCKET=xxx.appspot.com
VITE_FIREBASE_MESSAGING_SENDER_ID=xxxx

# Optional inference endpoints
VITE_INFER_URL=https://your-text-infer-endpoint
VITE_SPEECH_INFER_URL=https://your-speech-infer-endpoint
# Only set if the speech API expects X-API-Key
VITE_SPEECH_API_KEY=your-secret-key
```

3) é‡æ–°å•Ÿå‹• dev server å¾Œå³å¯ç™»å…¥ã€å¯«å…¥èˆ‡è®€å–æ—¥è¨˜ã€‚

## ä½¿ç”¨æ–¹å¼

- åœ¨è¼¸å…¥æ¡†è¼¸å…¥æ—¥è¨˜å…§å®¹
- é»žæ“Šã€Œå­˜æª”ã€å¾Œï¼Œä¸‹æ–¹æ¸…å–®æœƒå³æ™‚å‡ºç¾æ–°é …ç›®
- æ¸…å–®é¡¯ç¤ºæ—¥æœŸèˆ‡å‰ 30 å­—æ‘˜è¦ï¼Œä¾æ—¥æœŸæ–° â†’ èˆŠæŽ’åº
- å¯é‡æ•´æˆ–é—œé–‰é é¢ï¼Œè³‡æ–™ä»ä¿ç•™æ–¼æœ¬æ©Ÿï¼ˆ`localStorage`ï¼‰

è·¯ç”±ï¼š
- `/login`ï¼šç™»å…¥é ï¼ˆGoogle ç™»å…¥ï¼‰
- `/`ï¼šæ—¥è¨˜é ï¼ˆæ–°å¢žã€ç·¨è¼¯ã€åˆªé™¤ï¼›æŽ’åºï¼‰
- `/trash`ï¼šåžƒåœ¾æ¡¶ï¼ˆåƒ…é¡¯ç¤º `isDeleted=true`ï¼Œæ”¯æ´é‚„åŽŸ/æ°¸ä¹…åˆªé™¤ï¼‰

## å°ˆæ¡ˆçµæ§‹ï¼ˆé‡é»žï¼‰

- `src/App.jsx`ï¼šè·¯ç”±è¨­å®šï¼ˆå«ä¿è­·è·¯ç”±ï¼‰
- `src/pages/LoginPage.jsx`ï¼šç™»å…¥é 
- `src/pages/DiaryPage.jsx`ï¼šæ—¥è¨˜é ï¼ˆFirestore CRUDï¼šæ–°å¢žã€ç·¨è¼¯ã€è»Ÿåˆªé™¤ã€æŽ’åºï¼‰
- `src/pages/TrashPage.jsx`ï¼šåžƒåœ¾æ¡¶é ï¼ˆé‚„åŽŸï¼æ°¸ä¹…åˆªé™¤ï¼‰
- `src/state/AuthContext.jsx`ï¼šä½¿ç”¨è€…ç‹€æ…‹ï¼ˆFirebase Authï¼‰
- `src/lib/firebase.js`ï¼šFirebase åˆå§‹åŒ–ï¼ˆAuthã€Firestoreï¼‰
- `src/App.css`ã€`src/index.css`ï¼šæ¨£å¼
- `index.html`ï¼šé é¢å…¥å£
- `vite.config.js`ï¼šVite è¨­å®š
- `package.json`ï¼šè…³æœ¬èˆ‡ç›¸ä¾å¥—ä»¶

### ä¸»è¦ä½¿ç”¨çš„ Firebase API

```js
import { initializeApp } from 'firebase/app'
import { getAuth, GoogleAuthProvider, signInWithPopup, signOut } from 'firebase/auth'
import { getFirestore, collection, addDoc, getDocs, deleteDoc, doc } from 'firebase/firestore'
```
